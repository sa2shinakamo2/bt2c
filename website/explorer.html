<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BT2C - Block Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./css/styles.css">
    <style>
        .explorer-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .search-box {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            font-size: 1rem;
        }
        .stats-card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        .stats-card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transform: translateY(-2px);
        }
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        .data-table th {
            background-color: #f9fafb;
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            color: #4b5563;
            border-bottom: 1px solid #e5e7eb;
        }
        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .data-table tr:last-child td {
            border-bottom: none;
        }
        .data-table tr:hover {
            background-color: #f9fafb;
        }
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .badge-success {
            background-color: #d1fae5;
            color: #065f46;
        }
        .badge-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        .loading-spinner {
            display: inline-block;
            width: 1.5rem;
            height: 1.5rem;
            border: 3px solid rgba(156, 163, 175, 0.3);
            border-radius: 50%;
            border-top-color: #6366f1;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .hash-text {
            font-family: monospace;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Custom loading spinner */
        .loading-spinner {
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 3px solid #4f46e5;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Status badges */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            line-height: 1;
        }
        
        .badge-success {
            background-color: #d1fae5;
            color: #047857;
        }
        
        .badge-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        /* Hash text truncation */
        .hash-text {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Responsive grid layout */
        @media (max-width: 768px) {
            .grid-cols-1 {
                grid-template-columns: 1fr;
            }
        }
        
        /* Hover effects for interactive elements */
        .block-item, .transaction-item {
            transition: all 0.2s ease-in-out;
        }
        
        .block-item:hover, .transaction-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Validator rank styling */
        .rank-1 {
            font-weight: bold;
            color: #4f46e5;
        }
        
        .rank-2, .rank-3 {
            font-weight: bold;
        }
        
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Layout adjustments */
        .blocks-transactions-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        @media (min-width: 1024px) {
            .blocks-transactions-container {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <a href="/">
                            <div class="flex">
                                <svg class="h-8 w-8 text-indigo-600" viewBox="0 0 24 24">
                                    <path d="M12 2L2 19h20L12 2z" fill="currentColor"/>
                                </svg>
                                <svg class="h-8 w-8 text-indigo-600 -ml-4" viewBox="0 0 24 24">
                                    <path d="M12 2L2 19h20L12 2z" fill="currentColor"/>
                                </svg>
                            </div>
                            <span class="ml-2 text-xl font-semibold text-gray-900">BT2C</span>
                        </a>
                    </div>
                    <div class="hidden md:ml-6 md:flex md:space-x-8">
                        <a href="/" class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300">Home</a>
                        <a href="validators.html" class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300">Become a Validator</a>
                        <a href="explorer.html" class="inline-flex items-center px-1 pt-1 border-b-2 border-indigo-500 text-sm font-medium leading-5 text-gray-900">Explorer</a>
                        <a href="docs.html" class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300">Documentation</a>
                    </div>
                </div>
                <div class="flex items-center">
                    <a href="wallet.html" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Create Wallet
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="explorer-container">
        <!-- Hero Section -->
        <div class="bg-white shadow-sm rounded-lg p-6 mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">BT2C Blockchain Explorer</h1>
            <p class="text-gray-600 mb-6">Search and explore blocks, transactions, and addresses on the BT2C blockchain</p>
            
            <div class="relative">
                <input type="text" 
                       id="search" 
                       class="search-box pl-10"
                       placeholder="Search by block height, transaction hash, or wallet address..."
                       autocomplete="off">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                    </svg>
                </div>
            </div>
        </div>

        <!-- Search Results -->
        <div id="searchResults" class="hidden mb-8">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">Search Results</h2>
            <div id="resultsContent" class="bg-white shadow-sm rounded-lg p-6 space-y-4"></div>
        </div>

        <!-- Blockchain Stats -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="stats-card">
                <h3 class="text-sm font-medium text-gray-500 mb-1">Current Block Height</h3>
                <div class="flex items-center">
                    <div id="currentBlock" class="text-2xl font-bold text-gray-900">42,891</div>
                </div>
            </div>
            <div class="stats-card">
                <h3 class="text-sm font-medium text-gray-500 mb-1">Total Stake</h3>
                <div class="flex items-center">
                    <div id="totalStake" class="text-2xl font-bold text-gray-900">156,423</div>
                    <span class="ml-1 text-sm text-gray-500">BT2C</span>
                </div>
            </div>
            <div class="stats-card">
                <h3 class="text-sm font-medium text-gray-500 mb-1">Next Block In</h3>
                <div class="flex items-center">
                    <div id="nextBlockTime" class="text-2xl font-bold text-gray-900">37</div>
                    <span class="ml-1 text-sm text-gray-500">seconds</span>
                </div>
            </div>
        </div>

        <!-- Network Stats -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold mb-4">Network Information</h2>
            <div class="bg-white rounded-lg shadow overflow-hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4">
                    <div class="p-6 border-b md:border-b-0 md:border-r border-gray-200">
                        <h3 class="text-lg font-semibold mb-2">Block Time</h3>
                        <p id="blockTime" class="text-xl font-bold text-indigo-600">300s</p>
                        <p class="text-sm text-gray-500 mt-1">Target time between blocks</p>
                    </div>
                    <div class="p-6 border-b md:border-b-0 md:border-r border-gray-200">
                        <h3 class="text-lg font-semibold mb-2">Active Validators</h3>
                        <p id="activeValidatorsCount" class="text-xl font-bold text-indigo-600">24</p>
                        <p class="text-sm text-gray-500 mt-1">Nodes securing the network</p>
                    </div>
                    <div class="p-6 border-b lg:border-b-0 lg:border-r border-gray-200">
                        <h3 class="text-lg font-semibold mb-2">Network Status</h3>
                        <p id="networkStatus" class="text-xl font-bold text-green-600">Operational</p>
                        <p class="text-sm text-gray-500 mt-1">Current network health</p>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-semibold mb-2">API Endpoints</h3>
                        <div class="tooltip">
                            <p class="text-md font-medium text-indigo-600">api.bt2c.net</p>
                            <span class="tooltip-text">REST API: https://api.bt2c.net<br>WebSocket: wss://api.bt2c.net/ws</span>
                        </div>
                        <p class="text-sm text-gray-500 mt-1">For developers</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Active Validators -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold mb-4">Active Validators</h2>
            <div class="bg-white shadow overflow-hidden rounded-lg">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Validator</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stake</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Blocks Validated</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Uptime</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200" id="validatorsTable">
                            <!-- Sample validators data -->
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 rank-1">1</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    <div class="hash-text">0x7a23b54c1f9356d2dA5BB5539C7B290be3059c2E</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">12,450 BT2C</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">5,234</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">99.98%</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="badge badge-success">Active</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 rank-2">2</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    <div class="hash-text">0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">8,932 BT2C</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">4,129</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">99.87%</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="badge badge-success">Active</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 rank-3">3</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    <div class="hash-text">0x6B175474E89094C44Da98b954EedeAC495271d0F</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">7,215 BT2C</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">3,876</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">99.76%</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="badge badge-success">Active</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Latest Blocks and Transactions -->
        <div class="blocks-transactions-container">
            <!-- Latest Blocks -->
            <div>
                <h2 class="text-2xl font-bold mb-4">Latest Blocks</h2>
                <div class="bg-white shadow overflow-hidden rounded-lg">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Height</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Txs</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Validator</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="blocksTable">
                                <!-- Sample blocks data -->
                                <tr class="block-item">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">42,891</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2 mins ago</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">23</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x7a23b54c1f9356d2dA5BB5539C7B290be3059c2E</div>
                                    </td>
                                </tr>
                                <tr class="block-item">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">42,890</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">3 mins ago</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">18</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD</div>
                                    </td>
                                </tr>
                                <tr class="block-item">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">42,889</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">4 mins ago</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">12</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x6B175474E89094C44Da98b954EedeAC495271d0F</div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Latest Transactions -->
            <div>
                <h2 class="text-2xl font-bold mb-4">Latest Transactions</h2>
                <div class="bg-white shadow overflow-hidden rounded-lg">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hash</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">From</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">To</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="transactionsTable">
                                <!-- Sample transactions data -->
                                <tr class="transaction-item">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">
                                        <div class="hash-text">0x8a7d953d3812f2d9cf4bae8243b1280e1c1ec4347a3d1b8d3c66f4e1a6cd88a2</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x7a23b54c1f9356d2dA5BB5539C7B290be3059c2E</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">25.5 BT2C</td>
                                </tr>
                                <tr class="transaction-item">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">
                                        <div class="hash-text">0x2d9b57d92c7f1edb0a4a4b9be8e27c827f1f345a7c0e579f2d5ba8a716a5b94a</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x6B175474E89094C44Da98b954EedeAC495271d0F</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x7a23b54c1f9356d2dA5BB5539C7B290be3059c2E</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">18.2 BT2C</td>
                                </tr>
                                <tr class="transaction-item">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">
                                        <div class="hash-text">0x4f6742d1f701239b4b8e1b65a4d7c9be8a5156e1a6cd88a28a7d953d3812f2d9</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                        <div class="hash-text">0x6B175474E89094C44Da98b954EedeAC495271d0F</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">10.0 BT2C</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="flex justify-center space-x-6 md:order-2">
                <a href="https://github.com/sa2shinakamo2/bt2c" class="text-gray-400 hover:text-gray-500">
                    <span class="sr-only">GitHub</span>
                    <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                        <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/>
                    </svg>
                </a>
            </div>
            <div class="mt-8 md:mt-0 md:order-1">
                <p class="text-center text-base text-gray-400">
                    &copy; 2025 bit2coin. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // API URL - Change this to your validator API URL
        const API_URL = 'http://localhost:8081';
        
        // Fetch blockchain status
        async function fetchBlockchainStatus() {
            try {
                // Use the local API endpoint to get real blockchain data
                const response = await fetch(`${API_URL}/blockchain/status`);
                const data = await response.json();
                
                document.getElementById('currentBlock').textContent = data.block_height || '0';
                document.getElementById('totalStake').textContent = parseFloat(data.total_stake || '0').toFixed(2);
                document.getElementById('nextBlockTime').textContent = data.next_block_in || '0';
                document.getElementById('blockTime').textContent = `${data.block_time || '300'}s`;
                document.getElementById('activeValidatorsCount').textContent = data.active_validators || '1';
                document.getElementById('networkStatus').textContent = data.network ? 'Operational' : 'Maintenance';
                
                // Schedule next update - reduced to 5 seconds for more real-time updates
                setTimeout(fetchBlockchainStatus, 5000);
            } catch (error) {
                console.error('Error fetching blockchain status:', error);
                // Fallback to sample data if API fails
                document.getElementById('currentBlock').textContent = '0';
                document.getElementById('totalStake').textContent = '0.00';
                document.getElementById('nextBlockTime').textContent = '0';
                document.getElementById('blockTime').textContent = '300s';
                document.getElementById('activeValidatorsCount').textContent = '1';
                
                // Retry after 3 seconds on error
                setTimeout(fetchBlockchainStatus, 3000);
            }
        }
        
        // Fetch latest blocks
        async function fetchLatestBlocks() {
            try {
                document.getElementById('blocksTable').innerHTML = '<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-gray-500">Loading blocks...</td></tr>';
                
                // Use the local API endpoint to get real blockchain data
                const response = await fetch(`${API_URL}/blockchain/blocks`);
                const data = await response.json();
                const blocks = data.blocks || [];
                
                const blocksTable = document.getElementById('blocksTable');
                blocksTable.innerHTML = '';
                
                if (blocks.length === 0) {
                    blocksTable.innerHTML = '<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-gray-500">No blocks found</td></tr>';
                } else {
                    blocks.forEach(block => {
                        const blockTime = new Date(block.timestamp * 1000).toLocaleString();
                        const blockElement = document.createElement('tr');
                        blockElement.className = 'block-item';
                        blockElement.innerHTML = `
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">${block.height}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${blockTime}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${block.transactions}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <div class="hash-text">${block.validator}</div>
                            </td>
                        `;
                        
                        // Add click event to show block details
                        blockElement.addEventListener('click', () => {
                            handleSearch(block.height.toString());
                        });
                        
                        blocksTable.appendChild(blockElement);
                    });
                }
                
                // Schedule next update - reduced to 10 seconds for more real-time updates
                setTimeout(fetchLatestBlocks, 10000);
            } catch (error) {
                console.error('Error fetching latest blocks:', error);
                const blocksTable = document.getElementById('blocksTable');
                blocksTable.innerHTML = '<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-gray-500">Error loading blocks. Retrying...</td></tr>';
                
                // Retry after 5 seconds on error
                setTimeout(fetchLatestBlocks, 5000);
            }
        }
        
        // Fetch latest transactions
        async function fetchLatestTransactions() {
            try {
                document.getElementById('transactionsTable').innerHTML = '<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-gray-500">Loading transactions...</td></tr>';
                
                // Use the local API endpoint to get real blockchain data
                const response = await fetch(`${API_URL}/transactions/latest`);
                const data = await response.json();
                const transactions = data.transactions || [];
                
                const transactionsTable = document.getElementById('transactionsTable');
                transactionsTable.innerHTML = '';
                
                if (transactions.length === 0) {
                    transactionsTable.innerHTML = '<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-gray-500">No transactions found</td></tr>';
                } else {
                    transactions.forEach(tx => {
                        const txTime = new Date(tx.timestamp * 1000).toLocaleString();
                        const txElement = document.createElement('tr');
                        txElement.className = 'transaction-item';
                        txElement.innerHTML = `
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <div class="hash-text">${tx.hash}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <div class="hash-text">${tx.from}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <div class="hash-text">${tx.to}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${tx.amount} BT2C</td>
                        `;
                        
                        // Add click event to show transaction details
                        txElement.addEventListener('click', () => {
                            handleSearch(tx.hash);
                        });
                        
                        transactionsTable.appendChild(txElement);
                    });
                }
                
                // Schedule next update - reduced to 10 seconds for more real-time updates
                setTimeout(fetchLatestTransactions, 10000);
            } catch (error) {
                console.error('Error fetching latest transactions:', error);
                
                const transactionsTable = document.getElementById('transactionsTable');
                transactionsTable.innerHTML = '<tr><td colspan="4" class="px-6 py-4 text-center text-sm text-gray-500">Error loading transactions. Retrying...</td></tr>';
                
                // Retry after 5 seconds on error
                setTimeout(fetchLatestTransactions, 5000);
            }
        }
        
        // Fetch active validators
        async function fetchActiveValidators() {
            try {
                document.getElementById('validatorsTable').innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-sm text-gray-500">Loading validators...</td></tr>';
                
                // Use the local API endpoint to get real blockchain data
                const response = await fetch(`${API_URL}/validators/active`);
                const data = await response.json();
                const validators = data.validators || [];
                
                const validatorsTable = document.getElementById('validatorsTable');
                validatorsTable.innerHTML = '';
                
                if (validators.length === 0) {
                    validatorsTable.innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-sm text-gray-500">No active validators found</td></tr>';
                } else {
                    validators.forEach((validator, index) => {
                        const rankClass = index < 3 ? `rank-${index + 1}` : '';
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 ${rankClass}">${index + 1}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <div class="hash-text">${validator.address}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${validator.stake} BT2C</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${validator.blocks_validated || 0}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${validator.uptime || '100.00'}%</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="badge badge-success">Active</span>
                            </td>
                        `;
                        validatorsTable.appendChild(row);
                    });
                }
                
                // Schedule next update
                setTimeout(fetchActiveValidators, 30000);
            } catch (error) {
                console.error('Error fetching active validators:', error);
                document.getElementById('validatorsTable').innerHTML = '<tr><td colspan="6" class="px-6 py-4 text-center text-sm text-gray-500">Error loading validators. Retrying...</td></tr>';
                
                // Retry after 10 seconds on error
                setTimeout(fetchActiveValidators, 10000);
            }
        }
        
        // Handle search
        document.getElementById('search').addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                const searchTerm = this.value.trim();
                if (searchTerm) {
                    handleSearch(searchTerm);
                }
            }
        });
        
        async function handleSearch(searchTerm) {
            // Show search results section
            document.getElementById('searchResults').classList.remove('hidden');
            const resultsContent = document.getElementById('resultsContent');
            
            // Show loading indicator
            resultsContent.innerHTML = `
                <div class="flex justify-center items-center py-8">
                    <div class="loading-spinner mr-3"></div>
                    <span class="text-gray-500">Searching for "${searchTerm}"...</span>
                </div>
            `;
            
            try {
                // Determine search type (block height, transaction hash, or wallet address)
                let searchType, endpoint;
                
                if (!isNaN(searchTerm) && parseInt(searchTerm).toString() === searchTerm) {
                    // Block height search
                    searchType = 'block';
                    endpoint = `${API_URL}/blocks/${searchTerm}`;
                } else if (searchTerm.length === 64) {
                    // Transaction hash search
                    searchType = 'transaction';
                    endpoint = `${API_URL}/transactions/${searchTerm}`;
                } else {
                    // Wallet address search
                    searchType = 'wallet';
                    endpoint = `${API_URL}/wallet/${searchTerm}`;
                }
                
                const response = await fetch(endpoint);
                
                if (!response.ok) {
                    throw new Error(`Search failed with status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Clear previous results
                resultsContent.innerHTML = '';
                
                // Display results based on search type
                if (searchType === 'block') {
                    displayBlockResult(data, resultsContent);
                } else if (searchType === 'transaction') {
                    displayTransactionResult(data, resultsContent);
                } else if (searchType === 'wallet') {
                    displayWalletResult(data, resultsContent);
                }
            } catch (error) {
                console.error('Search error:', error);
                resultsContent.innerHTML = `
                    <div class="bg-red-50 border-l-4 border-red-400 p-4">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-red-700">
                                    No results found for "${searchTerm}". Please check your search term and try again.
                                </p>
                            </div>
                        </div>
                    </div>
                `;
            }
        }
        
        function displayBlockResult(block, container) {
            const blockTime = new Date(block.timestamp * 1000).toLocaleString();
            
            container.innerHTML = `
                <div class="bg-white rounded-lg overflow-hidden">
                    <div class="px-4 py-5 sm:px-6 bg-gray-50">
                        <h3 class="text-lg leading-6 font-medium text-gray-900">
                            Block #${block.height}
                        </h3>
                        <p class="mt-1 max-w-2xl text-sm text-gray-500">
                            Created at ${blockTime}
                        </p>
                    </div>
                    <div class="border-t border-gray-200">
                        <dl>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Block Hash</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 hash-text">${block.hash}</dd>
                            </div>
                            <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Previous Block</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                                    <a href="#" class="text-indigo-600 hover:text-indigo-900" onclick="handleSearch('${block.height - 1}'); return false;">
                                        ${block.height - 1}
                                    </a>
                                </dd>
                            </div>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Validator</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 hash-text">${block.validator}</dd>
                            </div>
                            <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Transactions</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${block.transactions}</dd>
                            </div>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Reward</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${block.reward} BT2C</dd>
                            </div>
                        </dl>
                    </div>
                </div>
            `;
        }
        
        function displayWalletResult(wallet, container) {
            container.innerHTML = `
                <div class="bg-white rounded-lg overflow-hidden">
                    <div class="px-4 py-5 sm:px-6 bg-gray-50">
                        <h3 class="text-lg leading-6 font-medium text-gray-900">
                            Wallet Details
                        </h3>
                        <p class="mt-1 max-w-2xl text-sm text-gray-500 hash-text">
                            ${wallet.address}
                        </p>
                    </div>
                    <div class="border-t border-gray-200">
                        <dl>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Balance</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${wallet.balance} BT2C</dd>
                            </div>
                            <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Staked</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${wallet.staked || 0} BT2C</dd>
                            </div>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Transactions</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${wallet.transactions}</dd>
                            </div>
                            <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Is Validator</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                                    ${wallet.is_validator ? 
                                        '<span class="badge badge-success">Yes</span>' : 
                                        '<span class="badge badge-pending">No</span>'}
                                </dd>
                            </div>
                        </dl>
                    </div>
                </div>
            `;
        }
        
        function displayTransactionResult(transaction, container) {
            const txTime = new Date(transaction.timestamp * 1000).toLocaleString();
            
            container.innerHTML = `
                <div class="bg-white rounded-lg overflow-hidden">
                    <div class="px-4 py-5 sm:px-6 bg-gray-50">
                        <div class="flex justify-between">
                            <div>
                                <h3 class="text-lg leading-6 font-medium text-gray-900">
                                    Transaction Details
                                </h3>
                                <p class="mt-1 max-w-2xl text-sm text-gray-500">
                                    Created at ${txTime}
                                </p>
                            </div>
                            <div>
                                ${transaction.confirmed ? 
                                    '<span class="badge badge-success">Confirmed</span>' : 
                                    '<span class="badge badge-pending">Pending</span>'}
                            </div>
                        </div>
                    </div>
                    <div class="border-t border-gray-200">
                        <dl>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Transaction Hash</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 hash-text">${transaction.hash}</dd>
                            </div>
                            <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">From</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${transaction.from}</dd>
                            </div>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">To</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${transaction.to}</dd>
                            </div>
                            <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Amount</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">${transaction.amount} BT2C</dd>
                            </div>
                            <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                <dt class="text-sm font-medium text-gray-500">Block</dt>
                                <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                                    ${transaction.block_height ? 
                                        `<a href="#" class="text-indigo-600 hover:text-indigo-900" onclick="handleSearch('${transaction.block_height}'); return false;">${transaction.block_height}</a>` : 
                                        'Pending'}
                                </dd>
                            </div>
                        </dl>
                    </div>
                </div>
            `;
        }
        
        // Initialize the explorer
        function initExplorer() {
            // Fetch blockchain status
            fetchBlockchainStatus();
            
            // Fetch latest blocks and transactions
            fetchLatestBlocks();
            fetchLatestTransactions();
            
            // Fetch active validators
            fetchActiveValidators();
            
            // Set up auto-refresh
            setInterval(() => {
                fetchBlockchainStatus();
                fetchActiveValidators();
            }, 30000); // Refresh status and validators every 30 seconds
            
            // More frequent updates for blocks and transactions
            // We don't need this interval since each function sets its own timeout
            // This prevents multiple simultaneous requests
        }
        
        // Start the explorer when the page loads
        window.addEventListener('load', initExplorer);
    </script>
</body>
</html>
